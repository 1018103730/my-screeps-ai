# 沉积物采集者设计案（设计阶段）

# 目标

- 在 config.ts 中配置后即可完全自动采集沉积物
- 配置需要指定沉积物所在旗帜的名称

# 生命周期

沉积物采集者类似于 collector。

**isNeed 阶段**

- 检查是否有指定名称的旗帜
- 从旗帜内存中读取沉积物的冷却信息，大于 100 tick 就不予生成，没有冷却信息或小于 100 tick 就进行生成。

**prepare 阶段**

- 检查旗帜内存中是否有移动路径，没有的话就寻路并写入内存，有的话就不再寻路。

**isReady 阶段**

- 内存中有移动路径就代表准备完成。

**source 阶段**

- 向 flag 所在位置移动，并开始记录移动需要的时长。
- 移动到了之后开始采集，并将移动所需的时间写入 flag 内存。

**target 阶段**

- 回家，将资源放在 terminal 里。

**switch 阶段**

- 身上资源满了，执行 target
- 冷却大于 100 tick，执行 target
- 自己的生存时间小于移动所需时间 + 20 tick（冗余），执行 target
- 身上资源空了，执行 source